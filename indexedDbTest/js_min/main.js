define(["domReady","bootstrap"],function(e){function o(e){var o={name:n.nameField.val(),surname:n.surnameField.val(),email:n.emailField.val()},t=e.transaction(["customers"],"readwrite"),r=t.objectStore("customers"),s=r.add(o);s.onsuccess=function(e){setTimeout(function(){window.location.href="index.html"},500)},s.onerror=function(e){console.log("Error: ",e),n.addAlert.addClass("visible"),setTimeout(function(){n.addAlert.removeClass("visible")},3e3),console.log("end err")}}function t(e){window.removeCustomer=function(o){console.log(o);var t=e.transaction(["customers"],"readwrite"),n=t.objectStore("customers"),r=n["delete"](o);r.onsuccess=function(){$("#row"+o).remove()},r.onerror=function(e){console.log("error -> ",e)}};var o=e.transaction(["customers"],"readonly"),t=o.objectStore("customers"),r=t.index("names"),s="";console.log("out -> ",s),r.openCursor().onsuccess=function(e){var o=e.target.result;console.log(o);var t="row"+o.value.id;o&&(s+="<tr id='"+t+"'><td>"+o.value.id+"</td><td><span>"+o.value.name+"</span></td><td><span>"+o.value.surname+"</span></td><td>"+o.value.email+"</td><td><a onclick='removeCustomer("+o.value.id+")'>USUN</a></td></tr>",o["continue"]()),console.log("out -> ",s),n.customersList.html(s)}}e(function(){var e,n=window.indexedDB.open("customers",8);n.onupgradeneeded=function(o){var t;e=o.target.result,console.log(e),e.objectStoreNames.contains("customers")||(t=e.createObjectStore("customers",{keyPath:"id",autoIncrement:!0}),t.createIndex("names","name",{unique:!1}))},n.onsuccess=function(o){console.log("polaczono",o),e=o.target.result,t(e)},n.onerror=function(e){console.log("blad: ",e)},$("#new-customer-form").on("submit",function(t){t.preventDefault(),o(e)}),$("#delete-customers").on("click",function(){window.indexedDB.deleteDatabase("customers"),window.location.href="index.html"}),console.log("dziala")});var n={nameField:$("#customerName"),surnameField:$("#customerSurname"),emailField:$("#customerMail"),addAlert:$("#add-alert"),customersList:$("#customers-list")}});