define(["domReady","jquery"],function(e){e(function(){function e(e){e.createSnake(),e.createFood(),e.setDirection("right"),e.gameLoop&&"undefined"!=typeof e.gameLoop&&clearInterval(e.gameLoop),e.gameLoop=setInterval(e.paint,e.getSpeed()),e.resetScore(),e.paint(),console.log("started")}var t=function(){function t(){F=0}function n(){var e=4;x=[];for(var t=e-1;t>-1;t--)x.push({x:t,y:0})}function r(){S={x:Math.round(Math.random()*(d-v)/v),y:Math.round(Math.random()*(p-v)/v)}}function i(){return D}function o(e,t,n){return k&&console.log(n,e,t),n.filter(function(n){return n.x===e&&n.y===t}).length}function c(){f.innerHTML=F,F>m&&(m=F,l.innerHTML=m)}function a(){function t(e,t){h.fillStyle="#FFF",h.fillRect(e*v,t*v,v,v),h.strokeStyle="#F00",h.strokeRect(e*v,t*v,v,v)}h.fillStyle="#000",h.fillRect(0,0,d,p),h.strokeStyle="#FFF",h.fillRect(0,0,d,p);var n=x[0].x,i=x[0].y;switch(y){case"right":n++;break;case"left":n--;break;case"down":i++;break;case"up":i--}if(-1===n||n>=d/v||-1===i||i>=p/v||o(n,i,x))return e(w);if(n===S.x&&i===S.y){var a={x:n,y:i};F++,r(),x.unshift(a)}else{var a=x.pop();a.x=n,a.y=i,x.unshift(a)}for(var u=0;u<x.length;u++){var s=x[u];t(s.x,s.y)}t(S.x,S.y),c(F)}function u(e){y=e}function s(){return y}function g(){k=!k}var f=($("#canvas")[0],$("#score")[0]),l=$("#high-score")[0],h=this.canvas.getContext("2d"),d=this.canvas.width,y="right",p=this.canvas.height,v=15,D=150,x=[],S={},k=!1,y="",F=0,m=-1;c(0);var w={getSpeed:i,createSnake:n,createFood:r,paint:a,setDirection:u,getDirection:s,toggleLogging:g,resetScore:t};return w}();!function(e){$(document).on("keydown",function(t){switch(t.which){case 32:return e.toggleLogging();case 37:return"right"!==e.getDirection()?e.setDirection("left"):e.getDirection();case 38:return"down"!==e.getDirection()?e.setDirection("up"):e.getDirection();case 39:return"left"!==e.getDirection()?e.setDirection("right"):e.getDirection();case 40:return"up"!==e.getDirection()?e.setDirection("down"):e.getDirection()}})}(t),e(t)})});