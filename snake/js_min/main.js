define(["domReady","jquery"],function(e){e(function(){function e(e){e.createSnake(),e.createFood(),e.setDirection("right"),e.startLoop(),e.resetScore(),e.paint(),console.log("started")}var t=function(){function t(){m=0}function n(){var e=4;H=[];for(var t=e-1;t>-1;t--)H.push({x:t,y:0})}function r(){b={x:Math.round(Math.random()*(x-L)/L),y:Math.round(Math.random()*(F-L)/L)}}function i(e,t,n){return R&&console.log(n,e,t),n.filter(function(n){return n.x===e&&n.y===t}).length}function o(){v.innerHTML=m,m>T&&(T=m,p.innerHTML=T)}function c(){function e(e,t){k.fillStyle="#FFF",k.fillRect(e*L,t*L,L,L),k.strokeStyle="#F00",k.strokeRect(e*L,t*L,L,L)}k.fillStyle="#000",k.fillRect(0,0,x,F),k.strokeStyle="#FFF",k.fillRect(0,0,x,F);var t=H[0].x,n=H[0].y;switch(S=w){case"right":t++;break;case"left":t--;break;case"down":n++;break;case"up":n--}if(-1===t||t>=x/L||-1===n||n>=F/L||i(t,n,H))return l(),h();if(t===b.x&&n===b.y){var c={x:t,y:n};m++,r(),H.unshift(c)}else{var c=H.pop();c.x=t,c.y=n,H.unshift(c)}for(var a=0;a<H.length;a++){var s=H[a];e(s.x,s.y)}e(b.x,b.y),o(m)}function a(e){w=e}function s(){return S}function u(){R=!R}function f(){d=setInterval(c,M)}function l(){d&&"undefined"!=typeof d&&clearInterval(d)}function g(){T=0,p.innerHTML=T}function h(){D.innerHTML=m,$(y).toggleClass("show")}var d,v=($("#canvas")[0],$("#score")[0]),y=$("#overlay")[0],D=$("#final-score")[0],p=$("#high-score")[0],k=this.canvas.getContext("2d"),x=this.canvas.width,S="right",w="direction",F=this.canvas.height,L=15,M=150,H=[],b={},R=!1,S="",m=0,T=-1;o(0),$("#reaload-btn").on("click",function(){h(),e(C)});var C={createSnake:n,createFood:r,paint:c,setDirection:a,getDirection:s,toggleLogging:u,resetScore:t,startLoop:f,clearLoop:l,resetHighScore:g};return C}();!function(e){$(document).on("keydown",function(t){switch(t.which){case 32:return e.toggleLogging();case 37:return"right"!==e.getDirection()?e.setDirection("left"):e.getDirection();case 38:return"down"!==e.getDirection()?e.setDirection("up"):e.getDirection();case 39:return"left"!==e.getDirection()?e.setDirection("right"):e.getDirection();case 40:return"up"!==e.getDirection()?e.setDirection("down"):e.getDirection()}}),$("#reset-btn").on("click",function(t){e.resetHighScore(),t.preventDefault()})}(t),e(t)})});