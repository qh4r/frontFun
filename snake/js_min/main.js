define(["domReady","jquery"],function(e){e(function(){function e(e){e.createSnake(),e.createFood(),e.setDirection("right"),e.startLoop(),e.resetScore(),e.paint(),console.log("started")}var t=function(){function t(){R=0}function n(){var e=4;M=[];for(var t=e-1;t>-1;t--)M.push({x:t,y:0})}function r(){H={x:Math.round(Math.random()*(x-F)/F),y:Math.round(Math.random()*(w-F)/F)}}function i(e,t,n){return b&&console.log(n,e,t),n.filter(function(n){return n.x===e&&n.y===t}).length}function o(){v.innerHTML=R,R>m&&(m=R,p.innerHTML=m)}function c(){function e(e,t){k.fillStyle="#FFF",k.fillRect(e*F,t*F,F,F),k.strokeStyle="#F00",k.strokeRect(e*F,t*F,F,F)}k.fillStyle="#000",k.fillRect(0,0,x,w),k.strokeStyle="#FFF",k.fillRect(0,0,x,w);var t=M[0].x,n=M[0].y;switch(S){case"right":t++;break;case"left":t--;break;case"down":n++;break;case"up":n--}if(-1===t||t>=x/F||-1===n||n>=w/F||i(t,n,M))return l(),h();if(t===H.x&&n===H.y){var c={x:t,y:n};R++,r(),M.unshift(c)}else{var c=M.pop();c.x=t,c.y=n,M.unshift(c)}for(var a=0;a<M.length;a++){var s=M[a];e(s.x,s.y)}e(H.x,H.y),o(R)}function a(e){S=e}function s(){return S}function u(){b=!b}function f(){d=setInterval(c,L)}function l(){d&&"undefined"!=typeof d&&clearInterval(d)}function g(){m=0,p.innerHTML=m}function h(){D.innerHTML=R,$(y).toggleClass("show")}var d,v=($("#canvas")[0],$("#score")[0]),y=$("#overlay")[0],D=$("#final-score")[0],p=$("#high-score")[0],k=this.canvas.getContext("2d"),x=this.canvas.width,S="right",w=this.canvas.height,F=15,L=150,M=[],H={},b=!1,S="",R=0,m=-1;o(0),$("#reaload-btn").on("click",function(){h(),e(T)});var T={createSnake:n,createFood:r,paint:c,setDirection:a,getDirection:s,toggleLogging:u,resetScore:t,startLoop:f,clearLoop:l,resetHighScore:g};return T}();!function(e){$(document).on("keydown",function(t){switch(t.which){case 32:return e.toggleLogging();case 37:return"right"!==e.getDirection()?e.setDirection("left"):e.getDirection();case 38:return"down"!==e.getDirection()?e.setDirection("up"):e.getDirection();case 39:return"left"!==e.getDirection()?e.setDirection("right"):e.getDirection();case 40:return"up"!==e.getDirection()?e.setDirection("down"):e.getDirection()}}),$("#reset-btn").on("click",function(t){e.resetHighScore(),t.preventDefault()})}(t),e(t)})});